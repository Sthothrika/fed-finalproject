<div class="row">
  <div class="col-12 mb-4">
    <h1>Welcome, <%= user.full_name || user.username %></h1>
    <p class="text-muted">Student dashboard — quick links and your daily routine.</p>
  </div>

  <div class="col-md-6 mb-4">
    <div class="card p-3 shadow-sm d-flex flex-row gap-3 align-items-center">
      <div class="profile-avatar" style="width:80px;height:80px;flex:0 0 80px">
        <% if (user.avatar) { %>
          <img src="<%= user.avatar %>" alt="avatar" class="profile-avatar-img">
        <% } else { 
             var displayName = user.full_name || user.username;
             var initials = (displayName || '').split(' ').map(function(n){return n ? n[0] : ''}).slice(0,2).join('').toUpperCase();
        %>
          <div class="profile-avatar-initials" style="font-size:20px"><%= initials || 'S' %></div>
        <% } %>
      </div>
      <div>
        <div class="col-12 mb-4">
          <div class="page-hero">
            <h1 class="title">Welcome, <%= user.full_name || user.username %></h1>
            <p class="subtitle">Student dashboard — quick links and your daily routine.</p>
          </div>
        </div>

        <div class="col-12 mb-4">
          <div class="card p-3 shadow-sm d-flex profile-grid align-items-start">
            <div class="profile-left d-flex align-items-center" style="gap:20px">
              <div class="avatar-ring" style="width:96px;height:96px;flex:0 0 96px">
                <div class="avatar-inner">
                  <% if (user.avatar) { %>
                    <img src="<%= user.avatar %>" alt="avatar">
                  <% } else { %>
                    <% var displayName = user.full_name || user.username; var initials = (displayName || '').split(' ').map(function(n){return n ? n[0] : ''}).slice(0,2).join('').toUpperCase(); %>
                    <div class="avatar-initials" style="font-size:22px"><%= initials || 'S' %></div>
                  <% } %>
                </div>
              </div>
              <div>
                <h5>Your Profile</h5>
                <p class="text-muted mb-1"><strong>Username:</strong> <span class="text-dark"> <%= user.username %></span></p>
                <p class="text-muted mb-1"><strong>Name:</strong> <span class="text-dark"> <%= user.full_name || 'Not set' %></span></p>
                <p class="text-muted mb-0"><strong>Phone:</strong> <span class="text-dark"> <%= user.phone || 'Not set' %></span></p>
                <div class="profile-actions mt-2">
                  <a href="/student/profile" class="btn btn-sm btn-outline-primary">View profile</a>
                  <a href="/student/profile/edit" class="btn btn-sm btn-primary ms-2">Edit</a>
                </div>
              </div>
            </div>

            <div class="profile-right">
              <div class="card-body p-0">
                <h5 class="mb-2">Today's Routine</h5>
                <div class="small text-muted">
                  <pre style="white-space:pre-wrap;margin:0"><%= routine || 'No routine set. Click edit to add one.' %></pre>
                </div>
                <div class="mt-3">
                  <a href="/resources" class="btn btn-sm btn-primary me-2">Resources</a>
                  <a href="/programs" class="btn btn-sm btn-outline-primary">Programs</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12">
          <div class="card p-3 shadow-sm">
            <h5>Enrolled Programs</h5>
            <% if (user.programs) { %>
              <div class="mt-2 program-pills">
                <% user.programs.split(',').map(p => p.trim()).filter(Boolean).forEach(function(pr){ %>
                  <span class="tag-badge"><%= pr %></span>
                <% }) %>
              </div>
            <% } else { %>
              <p class="small text-muted">You are not enrolled in any programs yet.</p>
            <% } %>
          </div>
        </div>
      </div>
